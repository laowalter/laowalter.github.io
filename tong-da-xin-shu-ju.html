<!DOCTYPE html>

<html lang="en-US">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="Walter" name="author">
<meta content="Walter" name="copyright">
<meta content="article" property="og:type">
<meta content="summary" name="twitter:card"/>
<meta content="通达信, tech, tech, " name="keywords">
<meta content="通达信数据 " property="og:title"/>
<meta content="./tong-da-xin-shu-ju.html" property="og:url"/>
<meta content="通达信数据结构解析 通达信自定义指数 相关文件： incon.dat 证监会行业、通达信新行业、申万行业等描述信息 T0002\hq_cache\block.dat 一般板块 T0002\hq_cache\block_gn.dat 概念板块 T0002\hq_cache\block_fg.dat 风格板块 T0002\hq_cache\block_zs.dat 指数板块 T0002\hq_cache\tdxhy.cfg 每个股票对应通达信行业和申万行业 T0002\hq_cache\tdxzs.cfg 板块指数，部分板块的最后一个字段映射到 incon.dat 的 TDXNHY 和 SWHY T0002\blocknew\blocknew.cfg 自定义板块概要描述文件 …" property="og:description"/>
<meta content="Just MEMO" property="og:site_name"/>
<meta content="Walter" property="og:article:author"/>
<meta content="2017-09-05T18:18:00+08:00" property="og:article:published_time"/>
<meta content="2017-09-05T18:18:00+08:00" property=""/>
<meta content="通达信数据 " name="twitter:title"/>
<meta content="通达信数据结构解析 通达信自定义指数 相关文件： incon.dat 证监会行业、通达信新行业、申万行业等描述信息 T0002\hq_cache\block.dat 一般板块 T0002\hq_cache\block_gn.dat 概念板块 T0002\hq_cache\block_fg.dat 风格板块 T0002\hq_cache\block_zs.dat 指数板块 T0002\hq_cache\tdxhy.cfg 每个股票对应通达信行业和申万行业 T0002\hq_cache\tdxzs.cfg 板块指数，部分板块的最后一个字段映射到 incon.dat 的 TDXNHY 和 SWHY T0002\blocknew\blocknew.cfg 自定义板块概要描述文件 …" name="twitter:description"/>
<title>通达信数据  · Just MEMO
</title>
<link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet"/>
<link href="//netdna.bootstrapcdn.com/font-awesome/4.0.1/css/font-awesome.css" rel="stylesheet"/>
<link href="./theme/css/pygments.css" media="screen" rel="stylesheet" type="text/css"/>
<link href="./theme/tipuesearch/tipuesearch.css" media="screen" rel="stylesheet" type="text/css"/>
<link href="./theme/css/elegant.css" media="screen" rel="stylesheet" type="text/css"/>
<link href="./theme/css/custom.css" media="screen" rel="stylesheet" type="text/css"/>
</meta></meta></meta></meta></head>
<body>
<div id="content-sans-footer">
<div class="navbar navbar-static-top">
<div class="navbar-inner">
<div class="container-fluid">
<a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</a>
<a class="brand" href="./"><span class="site-name">Just MEMO</span></a>
<div class="nav-collapse collapse">
<ul class="nav pull-right top-menu">
<li><a href=".">Home</a></li>
<li><a href="./categories.html">Categories</a></li>
<li><a href="./tags.html">Tags</a></li>
<li><a href="./archives.html">Archives</a></li>
<li><form action="./search.html" class="navbar-search" onsubmit="return validateForm(this.elements['q'].value);"> <input class="search-query" id="tipue_search_input" name="q" placeholder="Search" type="text"/></form></li>
</ul>
</div>
</div>
</div>
</div>
<div class="container-fluid">
<div class="row-fluid">
<div class="span1"></div>
<div class="span10">
<article>
<div class="row-fluid">
<header class="page-header span10 offset2">
<h1><a href="./tong-da-xin-shu-ju.html"> 通达信数据  </a></h1>
</header>
</div>
<div class="row-fluid">
<div class="span2 table-of-content">
<nav>
<h4>Contents</h4>
<div id="toc"><ul><li><a class="toc-href" href="#" title="通达信数据">通达信数据</a><ul><li><a class="toc-href" href="#tong da xin shu ju jie gou jie xi" title="通达信数据结构解析">通达信数据结构解析</a><ul><li><a class="toc-href" href="#tong da xin zi ding yi zhi shu" title="通达信自定义指数">通达信自定义指数</a></li><li><a class="toc-href" href="#xing ye ban kuai" title="行业板块">行业板块</a></li><li><a class="toc-href" href="#tong da xin zi ding yi ban kuai" title="通达信自定义板块">通达信自定义板块</a></li><li><a class="toc-href" href="#yong hu zi ding yi ban kuai" title="用户自定义板块">用户自定义板块</a></li><li><a class="toc-href" href="#ban kuai lie biao wen jian : *.blk" title="板块列表文件: *.blk">板块列表文件: *.blk</a></li><li><a class="toc-href" href="#tong da xin zi ding yi zhi shu_1" title="通达信自定义指数">通达信自定义指数</a></li><li><a class="toc-href" href="#mei ge gu piao dui ying de shen mo xing ye he tong da xin xing ye" title="每个股票对应的申万行业和通达信行业">每个股票对应的申万行业和通达信行业</a></li></ul></li></ul></li></ul></div>
</nav>
</div>
<div class="span8 article-content">
<h2 id="tong da xin shu ju jie gou jie xi"> 通达信数据结构解析 </h2>
<h3 id="tong da xin zi ding yi zhi shu"> 通达信自定义指数 </h3>
<ol>
<li> 相关文件：</li>
</ol>
<p>
<div class="justtable">
<table>
<thead>
<tr>
<th>incon.dat</th>
<th> 证监会行业、通达信新行业、申万行业等描述信息</th>
</tr>
</thead>
<tbody>
<tr>
<td>T0002\hq_cache\block.dat</td>
<td> 一般板块</td>
</tr>
<tr>
<td>T0002\hq_cache\block_gn.dat</td>
<td> 概念板块</td>
</tr>
<tr>
<td>T0002\hq_cache\block_fg.dat</td>
<td> 风格板块</td>
</tr>
<tr>
<td>T0002\hq_cache\block_zs.dat</td>
<td> 指数板块</td>
</tr>
<tr>
<td>T0002\hq_cache\tdxhy.cfg</td>
<td> 每个股票对应通达信行业和申万行业</td>
</tr>
<tr>
<td>T0002\hq_cache\tdxzs.cfg</td>
<td> 板块指数，部分板块的最后一个字段映射到 incon.dat 的 TDXNHY 和 SWHY</td>
</tr>
<tr>
<td>T0002\blocknew\blocknew.cfg</td>
<td> 自定义板块概要描述文件</td>
</tr>
</tbody>
</table>
</div></p>
<h3 id="xing ye ban kuai"> 行业板块 </h3>
<ol>
<li>
<p> 行业 </p>
<p> 行业包括三个类别：证监会行业；申万行业；通达信新行业 </p>
</li>
<li>
<p> 行业在文件 “incon.dat” 中定义。文件格式：</p>
<ol>
<li> 文件包含多个行业分类：<ol>
<li> 证监会行业：开头 #<span class="caps">ZJHHY</span>，结束 ######</li>
<li> 申万行业：开头 #<span class="caps">SWHY</span>，结束 ######</li>
<li> 通达信新行业：开头 #<span class="caps">TDXNHY</span>，结束 ######</li>
</ol>
</li>
<li> 每个分类中，每一行包含一个细分行业的代码和名称，以 “|” 分隔 <ol>
<li> 证监会行业：一级分类为 A~M，二级分类 A99，三级分类为 A9999</li>
<li> 申万行业：一级分类为 990000，二级分类为 999900，三级分类为 999999</li>
<li> 通达信新行业：一级分类为 T99，二级分类为 T9999，三级分类为 T999999</li>
</ol>
</li>
</ol>
</li>
<li>
<p> 示例如下：</p>
</li>
</ol>
<div class="highlight"><pre><span></span>    代码 | 名称
    #ZJHHY
    A| 农业
    A01| 农业
    A0101| 种植业
    A0199| 其他农业
    A03| 林业
    A0301| 林业
    ……
    #TDXNHY
    T01| 能源
    T0101| 煤炭
    T010101| 煤炭开采
    T010102| 焦炭加工
    T0102| 电力
    T010201| 水力发电
    T010202| 火力发电
    T010203| 新型电力
    ……
    #SWHY
    110000| 农业
    110100| 种植业
    110101| 种子生产
    110102| 粮食种植
    110103| 其他种植业
    110200| 渔业
</pre></div>
<h3 id="tong da xin zi ding yi ban kuai"> 通达信自定义板块 </h3>
<p> 通达信定义的板块通过如下四个板块文件描述：</p>
<p>
<div class="justtable">
<table>
<thead>
<tr>
<th>T0002\hq_cache\block.dat</th>
<th> 一般板块</th>
</tr>
</thead>
<tbody>
<tr>
<td>T0002\hq_cache\block_gn.dat</td>
<td> 概念板块</td>
</tr>
<tr>
<td>T0002\hq_cache\block_fg.dat</td>
<td> 风格板块</td>
</tr>
<tr>
<td>T0002\hq_cache\block_zs.dat</td>
<td> 指数板块</td>
</tr>
</tbody>
</table>
</div></p>
<p> 数据格式的 C 语言描述如下：</p>
<div class="highlight"><pre><span></span><span class="c1">// 股票板块信息文件头格式，T0002/hq_cache/block.dat block_fg.dat block_gn.dat block_zs.dat</span>
<span class="k">struct</span> <span class="n">TTDXBlockHeader</span>
<span class="p">{</span>
    <span class="kt">char</span>         <span class="n">szVersion</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>        <span class="c1">// 0, Registry ver:1.0 (1999-9-28)</span>
    <span class="kt">int</span>            <span class="n">nIndexOffset</span><span class="p">;</span>            <span class="c1">// 64, 0x00000054</span>
    <span class="kt">int</span>            <span class="n">nDataOffset</span><span class="p">;</span>            <span class="c1">// 68, 0x00000180</span>
    <span class="kt">int</span>            <span class="n">nData1</span><span class="p">;</span>                <span class="c1">// 72, 0x00000003</span>
    <span class="kt">int</span>            <span class="n">nData2</span><span class="p">;</span>                <span class="c1">// 76, 0x00000000</span>
    <span class="kt">int</span>            <span class="n">nData3</span><span class="p">;</span>                <span class="c1">// 80, 0x00000003</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">TTDXBlockIndex</span>
<span class="p">{</span>
    <span class="kt">char</span>        <span class="n">szName</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>            <span class="c1">// 0, Root, Block, Val</span>
    <span class="kt">int</span>            <span class="n">nData1</span><span class="p">;</span>                <span class="c1">// 64</span>
    <span class="kt">int</span>            <span class="n">nData2</span><span class="p">;</span>                <span class="c1">// 68</span>
    <span class="kt">int</span>            <span class="n">nLength</span><span class="p">;</span>                <span class="c1">// 72, length of the block</span>
    <span class="kt">int</span>            <span class="n">nOffset</span><span class="p">;</span>                <span class="c1">// 76, offset of the data part</span>
    <span class="kt">int</span>            <span class="n">nData3</span><span class="p">;</span>                <span class="c1">// 80</span>
    <span class="kt">int</span>            <span class="n">nData4</span><span class="p">;</span>                <span class="c1">// 84</span>
    <span class="kt">int</span>            <span class="n">nData5</span><span class="p">;</span>                <span class="c1">// 88, root=-1,block=0,val=1</span>
    <span class="kt">int</span>            <span class="n">nData6</span><span class="p">;</span>                <span class="c1">// 92, root=1,block=2,val=-1</span>
    <span class="kt">int</span>            <span class="n">nStatus</span><span class="p">;</span>                <span class="c1">// 96, 1</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">TTDXBlockRecord</span>
<span class="p">{</span>
    <span class="kt">char</span>         <span class="n">szName</span><span class="p">[</span><span class="mi">9</span><span class="p">];</span>
    <span class="kt">short</span>        <span class="n">nCount</span><span class="p">;</span>
    <span class="kt">short</span>        <span class="n">nLevel</span><span class="p">;</span>
    <span class="kt">char</span>         <span class="n">szCode</span><span class="p">[</span><span class="mi">400</span><span class="p">][</span><span class="mi">7</span><span class="p">];</span>
<span class="p">};</span>
</pre></div>
<h3 id="yong hu zi ding yi ban kuai"> 用户自定义板块 </h3>
<p> 基本目录：T0002\blocknew</p>
<p> 配置文件：blocknew.cfg  记录自定义的板块名称和文件头 </p>
<p> 配置文件存储格式：</p>
<p>1) 每个板块 120 字节
2) 板块名称 50 字节
3)  板块文件名头 70 字节 </p>
<div class="highlight"><pre><span></span><span class="c1">// 自定义板块概述文件格式，T0002\blocknew\blocknew.cfg</span>
<span class="k">struct</span> <span class="n">TTDXUserBlockRecord</span>
<span class="p">{</span>
    <span class="kt">char</span>        <span class="n">szName</span><span class="p">[</span><span class="mi">50</span><span class="p">];</span>
    <span class="kt">char</span>        <span class="n">szAbbr</span><span class="p">[</span><span class="mi">70</span><span class="p">];</span>        <span class="c1">// 也是文件名称前缀 T0002\blocknew\xxxx.blk</span>
<span class="p">};</span>
</pre></div>
<h3 id="ban kuai lie biao wen jian : *.blk"> 板块列表文件 : *.blk</h3>
<p> 每行一条记录：每个记录 7 个数字：</p>
<ol>
<li> 市场代码 1 位：0 – 深市；1 –  沪市 </li>
<li> 股票代码 6 位 </li>
<li> 行结束符：\r\n </li>
</ol>
<p>T0002\blocknew\<span class="caps">ZXG</span>.blk</p>
<p>
<div class="justtable">
<table>
<thead>
<tr>
<th>市场 </th>
<th> 股票代码</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>999999</td>
</tr>
<tr>
<td>0</td>
<td>399001</td>
</tr>
<tr>
<td>0</td>
<td>399005</td>
</tr>
<tr>
<td>0</td>
<td>399006</td>
</tr>
<tr>
<td>1</td>
<td>000016</td>
</tr>
<tr>
<td>1</td>
<td>000300</td>
</tr>
<tr>
<td>0</td>
<td>399330</td>
</tr>
</tbody>
</table>
</div></p>
<h3 id="tong da xin zi ding yi zhi shu_1"> 通达信自定义指数 </h3>
<p> 记录在文件 T0002\hq_cache\tdxzs.cfg 中，每行一条记录，每个记录包含 6 个字段，字段之间用 “,” 分隔。字段依次为：</p>
<p>
<div class="justtable">
<table>
<thead>
<tr>
<th>指数名称 </th>
<th> 指数代码 </th>
<th> 类别 <br/>2- 通达信行业板块 <br/>3- 地区板块 <br/>4- 概念板块 <br/>5- 风格板块 <br/>8- 申万行业 </th>
<th> 未知字段 <br/>( 都为 1)</th>
<th> 未知字段 <br/>( 都为 0)</th>
<th> 行业代码或板块代码 <br/>a) 类别为 2 时对应通达信行业代码 <br/>b) 类别为 3 对应地域编号，与 base.dbf 中的 DY 字段对应 <br/>c) 类别为 4 对应概念板块名称 <br/>d) 类别为 5 对应风格板块名称 <br/>e)  类别为 8 对应申万行业代码 </th></tr></thead></table></div></p></div></div></article></div></div></div></div></body></html>


<tbody>
<tr>
<td><p> 黑龙江 </p></td>
<td>880201</td>
<td>3</td>
<td>1</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td>新疆板块 </td>
<td>880202</td>
<td>3</td>
<td>1</td>
<td>0</td>
<td>2</td>
</tr>
<tr>
<td>吉林板块 </td>
<td>880203</td>
<td>3</td>
<td>1</td>
<td>0</td>
<td>3</td>
</tr>
<tr>
<td>甘肃板块 </td>
<td>880204</td>
<td>3</td>
<td>1</td>
<td>0</td>
<td>4</td>
</tr>
<tr>
<td>……</td>
</tr>
<tr>
<td>煤炭 </td>
<td>880301</td>
<td>2</td>
<td>1</td>
<td>0</td>
<td>T0101</td>
</tr>
<tr>
<td>煤炭开采 </td>
<td>880302</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>T010101</td>
</tr>
<tr>
<td>焦炭加工 </td>
<td>880303</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>T010102</td>
</tr>
<tr>
<td>电力 </td>
<td>880305</td>
<td>2</td>
<td>1</td>
<td>0</td>
<td>T0102</td>
</tr>
<tr>
<td>水力发电 </td>
<td>880306</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>T010201</td>
</tr>
</tbody>


<h3 id="mei ge gu piao dui ying de shen mo xing ye he tong da xin xing ye"> 每个股票对应的申万行业和通达信行业 </h3>
<p> 记录在文件 T0002\hq_cache\tdxhy.cfg 中：</p>
<p>
<div class="justtable">
<table>
<thead>
<tr>
<th>市场 </th>
<th> 股票代码 </th>
<th> 通达信新行业代码 </th>
<th> 申万行业代码</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>000001</td>
<td>T1001</td>
<td>440101</td>
</tr>
<tr>
<td>0</td>
<td>000002</td>
<td>T110201</td>
<td>430101</td>
</tr>
<tr>
<td>0</td>
<td>000004</td>
<td>T040502</td>
<td>370301</td>
</tr>
<tr>
<td>0</td>
<td>000005</td>
<td>T110202</td>
<td>430101</td>
</tr>
<tr>
<td>0</td>
<td>000006</td>
<td>T110202</td>
<td>430101</td>
</tr>
<tr>
<td>0</td>
<td>000007</td>
<td>T0604</td>
<td>460201</td>
</tr>
<tr>
<td>0</td>
<td>000008</td>
<td>T1301</td>
<td>510101</td>
</tr>
<tr>
<td>0</td>
<td>000009</td>
<td>T110201</td>
<td>430101</td>
</tr>
<tr>
<td>0</td>
<td>000010</td>
<td>T110101</td>
<td>250202</td>
</tr>
<tr>
<td>0</td>
<td>000011</td>
<td>T110202</td>
<td>430101</td>
</tr>
<tr>
<td>0</td>
<td>000012</td>
<td>T020603</td>
<td>250101</td>
</tr>
<tr>
<td>0</td>
<td>000014</td>
<td>T110201</td>
<td>430101</td>
</tr>
</tbody>
</table>
</div></p>
<hr/>
<section>
<h2>Related Posts</h2>
<ul class="related-posts-list">
<li><a href="./tong-da-xin-gong-shi-shou-ce.html" title="通达信公式手册">通达信公式手册</a></li>
<li><a href="./wo-de-tong-da-xin-gong-shi.html" title="我的通达信公式">我的通达信公式</a></li>
<li><a href="./tong-da-xin-shi-yong.html" title="通达信使用">通达信使用</a></li>
<li><a href="./devices.html" title="Devices">Devices</a></li>
<li><a href="./cron.html" title="Cron">Cron</a></li>
</ul>
<hr/>
</section>

<section>
<div class="span2" style="float:right;font-size:0.9em;">
<h4>Published</h4>
<time datetime="2017-09-05T18:18:00+08:00" pubdate="pubdate">Sep 5, 2017</time>
<h4>Last Updated</h4>
<time datetime="2017-09-05T18:18:00+08:00">Sep 5, 2017</time>
<h4>Category</h4>
<a class="category-link" href="./categories.html#tech-ref">tech</a>
<h4>Tags</h4>
<ul class="list-of-tags tags-in-article">
<li><a href="./tags.html#tech-ref">tech
                    <span>15</span>
</a></li>
<li><a href="./tags.html#tong-da-xin-ref">通达信
                    <span>4</span>
</a></li>
</ul>
<h4>Contact</h4>
<a class="sidebar-social-links" href="https://slashdot.org/" target="_blank" title="My IT新闻Slashdot Profile">
<i class="fa fa-it新闻slashdot sidebar-social-links"></i></a>
</div>
</section>



<div class="span1"></div>


<div id="push"></div>

<footer>
<div id="footer">
<ul class="footer-content">
<li class="elegant-power">Powered by <a href="http://getpelican.com/" title="Pelican Home Page">Pelican</a>. Theme: <a href="http://oncrashreboot.com/pelican-elegant" title="Theme Elegant Home Page">Elegant</a> by <a href="http://oncrashreboot.com" title="Talha Mansoor Home Page">Talha Mansoor</a></li>
</ul>
</div>
</footer> <script src="http://code.jquery.com/jquery.min.js"></script>
<script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
<script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

<!-- Theme: Elegant built for Pelican
    License : http://oncrashreboot.com/pelican-elegant -->
