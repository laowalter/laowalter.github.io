<!DOCTYPE html>
<html>
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie-edge">

    
    
    <link rel="stylesheet" href="/sass/main.min.6e3c2b079ee31b17abb26d025a098c60ce82093b938c09a95277f558ea824d75.css">

</head>

    
<head>
    
    

    
    
    <link href="css/section_number/section_number.css" rel="stylesheet" type="text/css">
    
</head>

    <body>
       <div class="homepage-header">
          <div class="homepage-left">
            <h1>书法大字典平台</h1> 
            <p>Sun Mar 19, 2017</p>
            <a class="tag tag--primary tag--small"   href=""><font color="green">Home</font></a>

            
                
                    <a class="tag tag--primary tag--small" href="tags/%E4%B9%A6%E6%B3%95">书法</a>
                
            
          </div>
      </div>

    <hr><br><nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#书法大字典维护日志">书法大字典维护日志</a></li>
<li><a href="#书法大字典iptables">书法大字典iptables</a>
<ul>
<li><a href="#停止iptables">停止iptables</a></li>
<li><a href="#启动iptables">启动iptables</a></li>
<li><a href="#启动knocd">启动knocd</a></li>
<li><a href="#目前的iptables-save">目前的iptables-save</a></li>
</ul></li>
<li><a href="#list-iptables-rules-and-remove-specific-one-rule">list iptables rules and remove specific one rule</a></li>
<li><a href="#微信公众平台安全模式消息体签名及加解密php代码示例-http-www-tk4479-net-muziduoxi-article-details-42024169"><a href="http://www.tk4479.net/muziduoxi/article/details/42024169">微信公众平台安全模式消息体签名及加解密PHP代码示例</a></a></li>
<li><a href="#add-certs">Add certs</a></li>
<li><a href="#shufadazidian-git">shufadazidian.git</a></li>
<li><a href="#回复自动添加微信文章操作步骤">回复自动添加微信文章操作步骤</a>
<ul>
<li><a href="#shufadazidian-newsreply-目录">shufadazidian/newsReply 目录</a></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</nav><article>
    

<h3 id="书法大字典维护日志">书法大字典维护日志</h3>

<ul>
<li>Sun 28 Jul 2019 11:19:03 AM CST
书法字典报警，重启apache，但是发现数据库无法通过 service mysqld start, 后直接在终端上运行 mysqld 后访问正常，就先这样了。</li>
</ul>

<h3 id="书法大字典iptables">书法大字典iptables</h3>

<h4 id="停止iptables">停止iptables</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">iptables -F
iptables -X
iptables -t nat -F
iptables -t nat -X
iptables -t mangle -F
iptables -t mangle -X
iptables -P INPUT ACCEPT
iptables -P OUTPUT ACCEPT
iptables -P FORWARD ACCEPT</code></pre></div>
<h4 id="启动iptables">启动iptables</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># iptable-resore ~/iptables.save</span></code></pre></div>
<h4 id="启动knocd">启动knocd</h4>

<pre><code>/etc/init.d/knock.d start
</code></pre>

<h4 id="目前的iptables-save">目前的iptables-save</h4>

<div class="file" >
    
    <div class="filename" >
        <p style="padding:0; margin:0;">filename: <b>iptable.save</b></p>
        <div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Generated by iptables-save v1.4.21 on Fri Jun 21 14:13:25 2019</span>
*filter
:INPUT DROP <span style="color:#f92672">[</span><span style="color:#ae81ff">866</span>:66314<span style="color:#f92672">]</span>
:FORWARD ACCEPT <span style="color:#f92672">[</span><span style="color:#ae81ff">0</span>:0<span style="color:#f92672">]</span>
:OUTPUT ACCEPT <span style="color:#f92672">[</span><span style="color:#ae81ff">13573</span>:27988128<span style="color:#f92672">]</span>
-A INPUT -p tcp -m tcp --dport <span style="color:#ae81ff">80</span> -m string --string <span style="color:#e6db74">&#34;w00tw00t&#34;</span> --algo bm --to <span style="color:#ae81ff">60</span> -j DROP
-A INPUT -p tcp -m tcp --dport <span style="color:#ae81ff">80</span> -m string --string <span style="color:#e6db74">&#34;rom-0&#34;</span> --algo bm --to <span style="color:#ae81ff">60</span> -j DROP
-A INPUT -p tcp -m tcp --dport <span style="color:#ae81ff">80</span> -m string --string <span style="color:#e6db74">&#34;Match1&#34;</span> --algo bm --to <span style="color:#ae81ff">60</span> -j DROP
-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT
-A INPUT -p tcp -m tcp --dport <span style="color:#ae81ff">80</span> -m state --state NEW,ESTABLISHED -j ACCEPT
-A INPUT -p tcp -m tcp --dport <span style="color:#ae81ff">443</span> -m state --state NEW,ESTABLISHED -j ACCEPT
-A INPUT -p tcp -m tcp --dport <span style="color:#ae81ff">9898</span> -m state --state NEW,ESTABLISHED -j ACCEPT
-A OUTPUT -p tcp -m tcp --sport <span style="color:#ae81ff">80</span> -m state --state RELATED,ESTABLISHED -j ACCEPT
-A OUTPUT -p tcp -m tcp --sport <span style="color:#ae81ff">443</span> -m state --state RELATED,ESTABLISHED -j ACCEPT
COMMIT
<span style="color:#75715e"># Completed on Fri Jun 21 14:13:25 2019</span></code></pre></div>
    </div>
</div>

<h3 id="list-iptables-rules-and-remove-specific-one-rule">list iptables rules and remove specific one rule</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo iptables -L --line-numbers
sudo iptables -D INPUT <span style="color:#ae81ff">3</span></code></pre></div>
<h3 id="微信公众平台安全模式消息体签名及加解密php代码示例-http-www-tk4479-net-muziduoxi-article-details-42024169"><a href="http://www.tk4479.net/muziduoxi/article/details/42024169">微信公众平台安全模式消息体签名及加解密PHP代码示例</a></h3>

<h3 id="add-certs">Add certs</h3>

<ol>
<li><a href="https://cloud.tencent.com/product/ssl?lang=en">从腾讯购买SSL证书</a></li>
<li>上传证书证书
[jtable]
/etc/apache2/ssl/, www.eliglad.com.crt www.eliglad.com.key
/etc/apache2/ssl.crt/, bundle.crt
[/jtable]</li>
<li>在服务器上修改 配置文件 /etc/apache2/apache.conf</li>
</ol>

<p>/etc/apache2/sites-available/default-ssl.conf</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">SSLEngine on
SSLCertificateFile      /etc/apache2/ssl/2_www.eliglad.com.crt
SSLCertificateKeyFile   /etc/apache2/ssl/3_www.eliglad.com.key
SSLCertificateChainFile /etc/apache2/ssl.crt/1_root_bundle.crt</code></pre></div>
<h3 id="shufadazidian-git">shufadazidian.git</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">git clone ssh://git@mini/~/shufadazidian.git</code></pre></div>
<h3 id="回复自动添加微信文章操作步骤">回复自动添加微信文章操作步骤</h3>

<h4 id="shufadazidian-newsreply-目录">shufadazidian/newsReply 目录</h4>

<ol>
<li><p>编辑newsList.txt</p>

<ol>
<li>tag 标记：mine(default), ads, others 任选其一；</li>
<li>picUrl使用：80x80 pixel；</li>
<li>所有内容不用加引号；</li>
<li>图像文件放入shufadazidian/newsReply/pics/</li>
<li>特别注意：<code>sum</code> 的总数量要对上，<code>block</code>的编号要按照顺序来。</li>
</ol></li>

<li><p>测试：可以在本地虚拟机Gentoo上测试, 直接执行 <code>upload_news_to_sql.pl</code></p></li>

<li><p>上传</p>

<ol>
<li>用手机打开服务器上传的端口</li>

<li><p>将本地文件打包:</p>

<ol>
<li>newsList.txt</li>
<li>upload_news_to_sql.pl</li>
<li>pics/</li>
</ol></li>

<li><p>sftp user@server, put 打包文件</p></li>

<li><p>在服务器将pics/文件拷贝到/var/www/html/data/news/pics/, chmod 644 *</p></li>

<li><p>执行<code>upload_news_to_sql.pl</code></p></li>

<li><p>关闭所有和服务器的链接，并用手机关闭服务器的服务端口</p></li>
</ol></li>

<li><p>newsConfig.txt demo</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#ae81ff">1</span> <span style="color:#f92672">[</span>summary<span style="color:#f92672">]</span>
<span style="color:#ae81ff">2</span> sum <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
<span style="color:#ae81ff">3</span>
<span style="color:#ae81ff">4</span> description1 <span style="color:#f92672">=</span><span style="color:#e6db74">&#34;字段例子按照下面demo中的写法&#34;</span>
<span style="color:#ae81ff">5</span> descpiption2 <span style="color:#f92672">=</span><span style="color:#e6db74">&#34;如果文字中间有逗号“，”就要用双引号把文字括起来&#34;</span>
<span style="color:#ae81ff">6</span> description3 <span style="color:#f92672">=</span><span style="color:#e6db74">&#34;sum表示所有block数量，不包括[demo]和[summary]&#34;</span>
<span style="color:#ae81ff">7</span>
<span style="color:#ae81ff">8</span> <span style="color:#f92672">[</span>demo<span style="color:#f92672">]</span>
<span style="color:#ae81ff">9</span> title <span style="color:#f92672">=</span> Not Null
<span style="color:#ae81ff">10</span> description <span style="color:#f92672">=</span> Not null
<span style="color:#ae81ff">11</span> picUrl <span style="color:#f92672">=</span> Not null
<span style="color:#ae81ff">12</span> url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;The static with whole path, not null&#34;</span>
<span style="color:#ae81ff">13</span> tag <span style="color:#f92672">=</span> Not null
<span style="color:#ae81ff">14</span> comments <span style="color:#f92672">=</span>
<span style="color:#ae81ff">15</span>
<span style="color:#ae81ff">16</span> <span style="color:#f92672">[</span>block1<span style="color:#f92672">]</span>
<span style="color:#ae81ff">17</span> title <span style="color:#f92672">=</span> 书法大字典<span style="color:#f92672">(</span><span style="color:#ae81ff">10</span>.7更新<span style="color:#f92672">)</span>
<span style="color:#ae81ff">18</span> description <span style="color:#f92672">=</span>《书法字典》手机网站
<span style="color:#ae81ff">19</span> picUrl <span style="color:#f92672">=</span> http://www.eliglad.com/data/pic/logo/zidian80.jpg
<span style="color:#ae81ff">20</span> url <span style="color:#f92672">=</span> http://www.eliglad.com/eliglad/index1007.html
<span style="color:#ae81ff">21</span> tag <span style="color:#f92672">=</span> fix
<span style="color:#ae81ff">22</span> priority <span style="color:#f92672">=</span> b
<span style="color:#ae81ff">23</span> comments <span style="color:#f92672">=</span> v
<span style="color:#ae81ff">24</span>
<span style="color:#ae81ff">25</span> <span style="color:#f92672">[</span>block2<span style="color:#f92672">]</span>
<span style="color:#ae81ff">26</span> title <span style="color:#f92672">=</span> 书法大字典<span style="color:#f92672">(</span><span style="color:#ae81ff">10</span>.8更新<span style="color:#f92672">)</span>
<span style="color:#ae81ff">27</span> description <span style="color:#f92672">=</span>《书法字典》手机网站
<span style="color:#ae81ff">28</span> picUrl <span style="color:#f92672">=</span> http://www.eliglad.com/data/pic/logo/zidian80.jpg
<span style="color:#ae81ff">29</span> url <span style="color:#f92672">=</span> http://www.eliglad.com/eliglad/index1008.html
<span style="color:#ae81ff">30</span> tag <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;fix&#39;</span>
<span style="color:#ae81ff">31</span> priority <span style="color:#f92672">=</span> a
<span style="color:#ae81ff">32</span> comments <span style="color:#f92672">=</span> a</code></pre></div></li>

<li><p>在 ～/bin目录中</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">read_newsConfig_to_sql.pl newsConfig.txt</code></pre></div></li>
</ol>

<p>将数据导入书库</p>

</article>

    </body>
</html>
