<!DOCTYPE html>
<html>
    
<head>
    <meta charset="UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" >

    <meta http-equiv="X-UA-Compatible" content="ie-edge">

    
    
    
    <link rel="stylesheet" href="http://laowalter.github.io/sass/main.min.efb631bfd6d06f69412228c8e8394e1b0993664013282ad6d79b7aba11a9efd0.css">

    <link rel="preload" as="font" href="/fonts/AdobeKaiStd-Regular.otf" crossorigin="anonymous">
    <link rel="preload" as="font" href="/fonts/AdobeHeitiStd-Regular.otf" crossorigin="anonymous">
    <link rel="preload" as="font" href="/fonts/Lobster-Regular.ttf" crossorigin="anonymous">


</head>

    
<head>
    
    

    
    
        
        <link href="http://laowalter.github.io/css/section_number/section_number.css" rel="stylesheet" type="text/css">
    
</head>

    <body width="device-width" >
      <div class="homepage-header">
          <div class="homepage-left">
            <h1>书法大字典平台</h1> 
            <p class="datetime">Sun, Mar 19, 2017</p>
            <a class="tag tag--primary tag--small"   href="/"><font color="green">Home</font></a>

            
                
                    
                    <a class="tag tag--primary tag--small" href="/tags/%E4%B9%A6%E6%B3%95">书法</a>
                
            
          </div>
      </div>

    <hr><br><nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#书法大字典维护日志">书法大字典维护日志</a></li>
<li><a href="#书法大字典iptables">书法大字典iptables</a>
<ul>
<li><a href="#停止iptables">停止iptables</a></li>
<li><a href="#启动iptables">启动iptables</a></li>
<li><a href="#启动knocd">启动knocd</a></li>
<li><a href="#目前的iptables-save">目前的iptables-save</a></li>
</ul></li>
<li><a href="#list-iptables-rules-and-remove-specific-one-rule">list iptables rules and remove specific one rule</a></li>
<li><a href="#微信公众平台安全模式消息体签名及加解密php代码示例-http-www-tk4479-net-muziduoxi-article-details-42024169"><a href="http://www.tk4479.net/muziduoxi/article/details/42024169">微信公众平台安全模式消息体签名及加解密PHP代码示例</a></a></li>
<li><a href="#add-certs">Add certs</a></li>
<li><a href="#shufadazidian-git">shufadazidian.git</a></li>
<li><a href="#回复自动添加微信文章操作步骤">回复自动添加微信文章操作步骤</a>
<ul>
<li><a href="#shufadazidian-newsreply-目录">shufadazidian/newsReply 目录</a></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</nav><article>
    

<h3 id="书法大字典维护日志">书法大字典维护日志</h3>

<ul>
<li>Sun 28 Jul 2019 11:19:03 AM CST
书法字典报警，重启apache，但是发现数据库无法通过 service mysqld start, 后直接在终端上运行 mysqld 后访问正常，就先这样了。</li>
</ul>

<h3 id="书法大字典iptables">书法大字典iptables</h3>

<h4 id="停止iptables">停止iptables</h4>
<div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">iptables -F
iptables -X
iptables -t nat -F
iptables -t nat -X
iptables -t mangle -F
iptables -t mangle -X
iptables -P INPUT ACCEPT
iptables -P OUTPUT ACCEPT
iptables -P FORWARD ACCEPT</code></pre></div>
<h4 id="启动iptables">启动iptables</h4>
<div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#080;background-color:#0f140f;font-style:italic"># iptable-resore ~/iptables.save</span></code></pre></div>
<h4 id="启动knocd">启动knocd</h4>

<pre><code>/etc/init.d/knock.d start
</code></pre>

<h4 id="目前的iptables-save">目前的iptables-save</h4>

<div class="file" >
    <div class="filename"> Filename: <b>iptable.save</b></div>
        <div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#080;background-color:#0f140f;font-style:italic"># Generated by iptables-save v1.4.21 on Fri Jun 21 14:13:25 2019</span>
*filter
:INPUT DROP [<span style="color:#0086f7;font-weight:bold">866</span>:66314]
:FORWARD ACCEPT [<span style="color:#0086f7;font-weight:bold">0</span>:0]
:OUTPUT ACCEPT [<span style="color:#0086f7;font-weight:bold">13573</span>:27988128]
-A INPUT -p tcp -m tcp --dport <span style="color:#0086f7;font-weight:bold">80</span> -m string --string <span style="color:#0086d2">&#34;w00tw00t&#34;</span> --algo bm --to <span style="color:#0086f7;font-weight:bold">60</span> -j DROP
-A INPUT -p tcp -m tcp --dport <span style="color:#0086f7;font-weight:bold">80</span> -m string --string <span style="color:#0086d2">&#34;rom-0&#34;</span> --algo bm --to <span style="color:#0086f7;font-weight:bold">60</span> -j DROP
-A INPUT -p tcp -m tcp --dport <span style="color:#0086f7;font-weight:bold">80</span> -m string --string <span style="color:#0086d2">&#34;Match1&#34;</span> --algo bm --to <span style="color:#0086f7;font-weight:bold">60</span> -j DROP
-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT
-A INPUT -p tcp -m tcp --dport <span style="color:#0086f7;font-weight:bold">80</span> -m state --state NEW,ESTABLISHED -j ACCEPT
-A INPUT -p tcp -m tcp --dport <span style="color:#0086f7;font-weight:bold">443</span> -m state --state NEW,ESTABLISHED -j ACCEPT
-A INPUT -p tcp -m tcp --dport <span style="color:#0086f7;font-weight:bold">9898</span> -m state --state NEW,ESTABLISHED -j ACCEPT
-A OUTPUT -p tcp -m tcp --sport <span style="color:#0086f7;font-weight:bold">80</span> -m state --state RELATED,ESTABLISHED -j ACCEPT
-A OUTPUT -p tcp -m tcp --sport <span style="color:#0086f7;font-weight:bold">443</span> -m state --state RELATED,ESTABLISHED -j ACCEPT
COMMIT
<span style="color:#080;background-color:#0f140f;font-style:italic"># Completed on Fri Jun 21 14:13:25 2019</span></code></pre></div>
</div>

<h3 id="list-iptables-rules-and-remove-specific-one-rule">list iptables rules and remove specific one rule</h3>
<div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo iptables -L --line-numbers
sudo iptables -D INPUT <span style="color:#0086f7;font-weight:bold">3</span></code></pre></div>
<h3 id="微信公众平台安全模式消息体签名及加解密php代码示例-http-www-tk4479-net-muziduoxi-article-details-42024169"><a href="http://www.tk4479.net/muziduoxi/article/details/42024169">微信公众平台安全模式消息体签名及加解密PHP代码示例</a></h3>

<h3 id="add-certs">Add certs</h3>

<ol>
<li><a href="https://cloud.tencent.com/product/ssl?lang=en">从腾讯购买SSL证书</a></li>
<li>上传证书证书
[jtable]
/etc/apache2/ssl/, www.eliglad.com.crt www.eliglad.com.key
/etc/apache2/ssl.crt/, bundle.crt
[/jtable]</li>
<li>在服务器上修改 配置文件 /etc/apache2/apache.conf</li>
</ol>

<p>/etc/apache2/sites-available/default-ssl.conf</p>
<div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">SSLEngine on
SSLCertificateFile      /etc/apache2/ssl/2_www.eliglad.com.crt
SSLCertificateKeyFile   /etc/apache2/ssl/3_www.eliglad.com.key
SSLCertificateChainFile /etc/apache2/ssl.crt/1_root_bundle.crt</code></pre></div>
<h3 id="shufadazidian-git">shufadazidian.git</h3>
<div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">git clone ssh://git@mini/~/shufadazidian.git</code></pre></div>
<h3 id="回复自动添加微信文章操作步骤">回复自动添加微信文章操作步骤</h3>

<h4 id="shufadazidian-newsreply-目录">shufadazidian/newsReply 目录</h4>

<ol>
<li><p>编辑newsList.txt</p>

<ol>
<li>tag 标记：mine(default), ads, others 任选其一；</li>
<li>picUrl使用：80x80 pixel；</li>
<li>所有内容不用加引号；</li>
<li>图像文件放入shufadazidian/newsReply/pics/</li>
<li>特别注意：<code>sum</code> 的总数量要对上，<code>block</code>的编号要按照顺序来。</li>
</ol></li>

<li><p>测试：可以在本地虚拟机Gentoo上测试, 直接执行 <code>upload_news_to_sql.pl</code></p></li>

<li><p>上传</p>

<ol>
<li>用手机打开服务器上传的端口</li>

<li><p>将本地文件打包:</p>

<ol>
<li>newsList.txt</li>
<li>upload_news_to_sql.pl</li>
<li>pics/</li>
</ol></li>

<li><p>sftp user@server, put 打包文件</p></li>

<li><p>在服务器将pics/文件拷贝到/var/www/html/data/news/pics/, chmod 644 *</p></li>

<li><p>执行<code>upload_news_to_sql.pl</code></p></li>

<li><p>关闭所有和服务器的链接，并用手机关闭服务器的服务端口</p></li>
</ol></li>

<li><p>newsConfig.txt demo</p>
<div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#0086f7;font-weight:bold">1</span> [summary]
<span style="color:#0086f7;font-weight:bold">2</span> <span style="color:#fb660a">sum</span> = <span style="color:#0086f7;font-weight:bold">2</span>
<span style="color:#0086f7;font-weight:bold">3</span>
<span style="color:#0086f7;font-weight:bold">4</span> <span style="color:#fb660a">description1</span> =<span style="color:#0086d2">&#34;字段例子按照下面demo中的写法&#34;</span>
<span style="color:#0086f7;font-weight:bold">5</span> <span style="color:#fb660a">descpiption2</span> =<span style="color:#0086d2">&#34;如果文字中间有逗号“，”就要用双引号把文字括起来&#34;</span>
<span style="color:#0086f7;font-weight:bold">6</span> <span style="color:#fb660a">description3</span> =<span style="color:#0086d2">&#34;sum表示所有block数量，不包括[demo]和[summary]&#34;</span>
<span style="color:#0086f7;font-weight:bold">7</span>
<span style="color:#0086f7;font-weight:bold">8</span> [demo]
<span style="color:#0086f7;font-weight:bold">9</span> <span style="color:#fb660a">title</span> = Not Null
<span style="color:#0086f7;font-weight:bold">10</span> <span style="color:#fb660a">description</span> = Not null
<span style="color:#0086f7;font-weight:bold">11</span> <span style="color:#fb660a">picUrl</span> = Not null
<span style="color:#0086f7;font-weight:bold">12</span> <span style="color:#fb660a">url</span> = <span style="color:#0086d2">&#34;The static with whole path, not null&#34;</span>
<span style="color:#0086f7;font-weight:bold">13</span> <span style="color:#fb660a">tag</span> = Not null
<span style="color:#0086f7;font-weight:bold">14</span> <span style="color:#fb660a">comments</span> =
<span style="color:#0086f7;font-weight:bold">15</span>
<span style="color:#0086f7;font-weight:bold">16</span> [block1]
<span style="color:#0086f7;font-weight:bold">17</span> <span style="color:#fb660a">title</span> = 书法大字典(<span style="color:#0086f7;font-weight:bold">10</span>.7更新)
<span style="color:#0086f7;font-weight:bold">18</span> <span style="color:#fb660a">description</span> =《书法字典》手机网站
<span style="color:#0086f7;font-weight:bold">19</span> <span style="color:#fb660a">picUrl</span> = http://www.eliglad.com/data/pic/logo/zidian80.jpg
<span style="color:#0086f7;font-weight:bold">20</span> <span style="color:#fb660a">url</span> = http://www.eliglad.com/eliglad/index1007.html
<span style="color:#0086f7;font-weight:bold">21</span> <span style="color:#fb660a">tag</span> = fix
<span style="color:#0086f7;font-weight:bold">22</span> <span style="color:#fb660a">priority</span> = b
<span style="color:#0086f7;font-weight:bold">23</span> <span style="color:#fb660a">comments</span> = v
<span style="color:#0086f7;font-weight:bold">24</span>
<span style="color:#0086f7;font-weight:bold">25</span> [block2]
<span style="color:#0086f7;font-weight:bold">26</span> <span style="color:#fb660a">title</span> = 书法大字典(<span style="color:#0086f7;font-weight:bold">10</span>.8更新)
<span style="color:#0086f7;font-weight:bold">27</span> <span style="color:#fb660a">description</span> =《书法字典》手机网站
<span style="color:#0086f7;font-weight:bold">28</span> <span style="color:#fb660a">picUrl</span> = http://www.eliglad.com/data/pic/logo/zidian80.jpg
<span style="color:#0086f7;font-weight:bold">29</span> <span style="color:#fb660a">url</span> = http://www.eliglad.com/eliglad/index1008.html
<span style="color:#0086f7;font-weight:bold">30</span> <span style="color:#fb660a">tag</span> = <span style="color:#0086d2">&#39;fix&#39;</span>
<span style="color:#0086f7;font-weight:bold">31</span> <span style="color:#fb660a">priority</span> = a
<span style="color:#0086f7;font-weight:bold">32</span> <span style="color:#fb660a">comments</span> = a</code></pre></div></li>

<li><p>在 ～/bin目录中</p>
<div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">read_newsConfig_to_sql.pl newsConfig.txt</code></pre></div></li>
</ol>

<p>将数据导入书库</p>

</article>

    <hr><br>
<p class="center">ONLY FOR MY PERSONAL USE. <br> ALL RIGHTS RESERVED. </p>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>

    </body>
</html>
